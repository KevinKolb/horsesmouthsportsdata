<!DOCTYPE html>
<!-- 
    DOCTYPE declaration tells the browser this is HTML5
    Always put this at the very top of HTML documents
-->
<html lang="en">
<!-- 
    <html> is the root element that contains everything
    lang="en" tells screen readers and browsers the page language
-->
<head>
    <!-- 
        <head> contains metadata about the page - not visible to users
        This is where we put CSS, page title, character encoding, etc.
    -->
    <meta charset="UTF-8">
    <!-- Tells browser how to interpret text characters (UTF-8 supports all languages) -->
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 
        CRITICAL for mobile responsiveness!
        Tells mobile browsers to match screen width and don't zoom out
        Without this, mobile sites look tiny and zoomed out
    -->
    
    <title>SPORTS.XML</title>
    <!-- Text that appears in browser tab/bookmark -->
    
    <style>
        /* 
            CSS (Cascading Style Sheets) goes between <style> tags
            CSS controls how HTML elements look and are positioned
            Format: selector { property: value; }
        */
        
        * {
            /* 
                * is the "universal selector" - applies to ALL elements
                This is a CSS reset to remove browser default spacing
            */
            margin: 0;          /* Remove default margins */
            padding: 0;         /* Remove default padding */
            box-sizing: border-box;  /* Makes width/height include padding/borders */
        }

        body {
            /* 
                body contains all visible content
                Setting styles here affects the entire page
            */
            font-family: 'Helvetica Neue', Arial, sans-serif;  /* Font stack - browser tries first, falls back */
            background: #fafafa;    /* Light gray background (#fafafa is hex color) */
            color: #333;            /* Dark gray text color */
            line-height: 1.4;       /* Space between lines (1.4 = 140% of font size) */
        }

        .container {
            /* 
                Classes in CSS start with a period (.)
                This targets any element with class="container"
            */
            max-width: 1200px;      /* Wider container for more complex sport data */
            margin: 0 auto;         /* Centers the container horizontally */
            padding: 30px 20px;     /* 30px top/bottom, 20px left/right */
        }

        header {
            /* 
                This targets the <header> HTML element (no period = element selector)
                Header is a semantic HTML5 element for page/section headers
            */
            text-align: center;             /* Centers text horizontally */
            margin-bottom: 40px;            /* Space below header */
            border-bottom: 1px solid #e0e0e0;  /* Thin gray line below */
            padding-bottom: 25px;           /* Space between content and border */
        }

        h1 {
            /* Targets all <h1> elements (main heading) */
            font-size: 2.5rem;      /* rem = relative to root font size, more responsive than px */
            font-weight: 100;       /* Very thin font weight (100-900, 400 is normal) */
            letter-spacing: -0.02em; /* Slightly tighter letter spacing */
            margin-bottom: 8px;     /* Space below heading */
        }

        .subtitle {
            /* Class selector for subtitle text */
            font-size: 1rem;        /* 1rem = default font size */
            color: #666;            /* Medium gray */
            font-weight: 300;       /* Light font weight */
            margin-bottom: 12px;
        }

        .attribution {
            /* Styling for author/credit information */
            font-size: 0.8rem;      /* Smaller than default */
            color: #999;            /* Light gray */
            font-weight: 300;
            margin-bottom: 20px;
            line-height: 1.3;       /* Tighter line spacing for small text */
        }

        .button-group {
            /* Container for buttons using Flexbox layout */
            display: flex;          /* Flexbox = flexible box layout system */
            gap: 15px;             /* Space between flex items (modern CSS property) */
            justify-content: center; /* Centers flex items horizontally */
            flex-wrap: wrap;        /* Allows buttons to wrap on small screens */
        }

        .download-btn, .home-btn, .filter-btn {
            /* 
                Multiple selectors separated by commas
                Styles apply to elements with ANY of these classes
            */
            display: inline-block;   /* Makes links behave like buttons */
            background: #333;        /* Dark background */
            color: white;           /* White text */
            text-decoration: none;   /* Removes underline from links */
            padding: 8px 16px;      /* 8px top/bottom, 16px left/right */
            font-size: 0.85rem;
            font-weight: 400;       /* Normal weight */
            letter-spacing: 0.5px;  /* Slightly spaced out letters */
            text-transform: uppercase; /* Makes text ALL CAPS */
            transition: background 0.3s ease; /* Smooth color change on hover */
            border: none;           /* Remove default button border */
            cursor: pointer;        /* Show pointer cursor on hover */
        }

        .download-btn:hover, .home-btn:hover, .filter-btn:hover {
            /* 
                :hover is a pseudo-class - activates when mouse hovers
                Creates interactive feedback for users
            */
            background: #555;       /* Lighter gray on hover */
        }

        .filter-btn.active {
            /* 
                .filter-btn.active targets elements with BOTH classes
                Used to highlight the currently selected filter
            */
            background: #e74c3c;    /* Red background for active filter */
        }

        .filter-btn.active:hover {
            background: #c0392b;    /* Darker red on hover for active filter */
        }

        .stats-bar {
            /* Container for statistics display */
            background: white;
            border: 1px solid #e8e8e8;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;          /* Flexbox for horizontal layout */
            justify-content: space-between; /* Spread items across space */
            align-items: center;
            flex-wrap: wrap;        /* Allow wrapping on small screens */
            gap: 20px;
        }

        .stat-item {
            /* Individual statistic display */
            text-align: center;
        }

        .stat-number {
            /* Large number display */
            font-size: 1.8rem;
            font-weight: bold;
            color: #e74c3c;         /* Red color for emphasis */
            display: block;         /* Forces to new line */
        }

        .stat-label {
            /* Label below the number */
            font-size: 0.9rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sports-container {
            /* Main container for all sports */
            display: grid;              /* CSS Grid for layout */
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Responsive columns */
            gap: 30px;                  /* Space between grid items */
            margin-top: 30px;
        }

        .sport-card {
            /* Individual sport display card */
            background: white;
            border: 1px solid #e8e8e8;
            border-radius: 8px;         /* Rounded corners */
            overflow: hidden;           /* Keeps content within rounded corners */
            transition: transform 0.2s ease, box-shadow 0.2s ease; /* Smooth hover animation */
        }

        .sport-card:hover {
            /* Hover effect for sport cards */
            transform: translateY(-2px); /* Slight upward movement */
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); /* Shadow effect */
        }

        .sport-header {
            /* Header section of each sport card */
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .sport-rank {
            /* Rank number in sport header */
            position: absolute;
            top: 10px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .sport-name {
            /* Main sport name */
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .sport-participants {
            /* Participant count display */
            font-size: 1rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .sport-body {
            /* Main content area of sport card */
            padding: 20px;
        }

        .section-title {
            /* Title for sections within sport cards */
            font-size: 1rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #e74c3c;
            padding-bottom: 5px;
        }

        .regions-list {
            /* Container for primary regions */
            background: #f8f9fa;       /* Very light gray background */
            border-left: 3px solid #e74c3c; /* Red accent bar */
            border-radius: 0 4px 4px 0; /* Rounded right corners only */
            padding: 15px;
            margin-bottom: 15px;
        }

        .sport-links {
            /* Container for sport action links */
            padding-top: 15px;
            border-top: 1px solid #eee;
            text-align: center;
        }

        .leagues-link {
            /* Styling for leagues link button */
            display: inline-block;
            background: #e74c3c;
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            font-size: 0.9rem;
            font-weight: 500;
            border-radius: 4px;
            transition: background 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .leagues-link:hover {
            background: #c0392b;            /* Darker red on hover */
        }

        .loading {
            /* Styles for loading message */
            text-align: center;
            padding: 60px 40px;
            font-size: 1.2rem;
            color: #666;
            background: white;
            border: 1px solid #e8e8e8;
            border-radius: 8px;
        }

        .error {
            /* Styles for error message */
            text-align: center;
            padding: 60px 40px;
            color: #e74c3c;         /* Red for errors */
            font-size: 1.1rem;
            background: white;
            border: 1px solid #e8e8e8;
            border-radius: 8px;
        }

        .hidden {
            /* Utility class to hide elements */
            display: none !important;  /* !important overrides other display values */
        }

        /* 
            POPULARITY-BASED STYLING
            Different colors based on popularity rank to create visual hierarchy
        */
        .rank-1-5 .sport-header { background: #2c5234; }     /* Dark green for top 5 */
        .rank-6-10 .sport-header { background: #1e3a8a; }    /* Blue for 6-10 */
        .rank-11-15 .sport-header { background: #dc2626; }   /* Red for 11-15 */
        .rank-16-20 .sport-header { background: #374151; }   /* Dark gray for 16-20 */
        .rank-21-25 .sport-header { background: #059669; }   /* Green for 21-25 */

        /* 
            MEDIA QUERY for responsive design
            @media targets specific screen conditions
        */
        @media (max-width: 768px) {
            /* These styles only apply when screen is 768px wide or smaller (tablets/phones) */
            
            .container {
                padding: 20px 15px;     /* Less padding on small screens */
            }
            
            h1 {
                font-size: 2rem;        /* Smaller heading on mobile */
            }

            .sports-container {
                grid-template-columns: 1fr; /* Single column on mobile */
                gap: 20px;
            }

            .stats-bar {
                flex-direction: column; /* Stack stats vertically on mobile */
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            /* Extra small screens (phones in portrait) */
            .button-group {
                flex-direction: column; /* Stack buttons vertically */
                align-items: center;
            }

            .filter-btn, .download-btn, .home-btn {
                width: 200px;          /* Fixed width for better touch targets */
            }
        }
    </style>
</head>
<body>
    <!-- 
        <body> contains all visible page content
        Everything users see and interact with goes here
    -->
    
    <div class="container">
        <!-- 
            <div> is a generic container element
            class="container" applies the .container CSS styles
        -->
        
        <header>
            <!-- Semantic HTML5 element for page header -->
            
            <h1>SPORTS.XML</h1>
            <!-- <h1> is the main page heading (most important) -->
            
            <p class="subtitle">Horses Mouth Sports Data</p>
            <!-- <p> = paragraph, class applies .subtitle styles -->
            
            <p class="attribution">Generated with AI assistance and maintained manually by kevinmkolb@gmail.com.</p>
            <!-- Attribution/credit paragraph -->
            
            <div class="button-group">
                <!-- Container for navigation and download buttons (first line) -->
                
                <a href="https://kevinkolb.github.io/horsesmouthsportsdata" class="home-btn">Home</a>
                <!-- 
                    <a> = anchor/link element
                    href = destination URL
                    class applies button styling
                -->
                
                <a href="sports.xml" download class="download-btn">Download sports.xml</a>
                <!-- Download link for sports data -->
                
                <a href="leagues.xml" download class="download-btn">Download leagues.xml</a>
                <!-- 
                    download attribute makes browser download the file instead of navigating to it
                    Useful for providing data files to users
                -->
            </div>
            
            <div class="button-group" style="margin-top: 15px;">
                <!-- Container for filter buttons (second line) -->
                
                <button class="filter-btn active" data-rank="all">All Sports</button>
                <button class="filter-btn" data-rank="1-5">Top 5</button>
                <button class="filter-btn" data-rank="6-10">6-10</button>
                <button class="filter-btn" data-rank="11-15">11-15</button>
                <button class="filter-btn" data-rank="16-20">16-20</button>
                <button class="filter-btn" data-rank="21-25">21-25</button>
                <!-- 
                    data-rank is a custom data attribute
                    Used to store filter information for JavaScript
                    Can be accessed via element.dataset.rank
                -->
            </div>
        </header>

        <div class="stats-bar">
            <!-- Statistics display bar -->
            <div class="stat-item">
                <span class="stat-number" id="total-sports">-</span>
                <span class="stat-label">Total Sports</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="total-participants">-</span>
                <span class="stat-label">Participants (Billions)</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="unique-regions">-</span>
                <span class="stat-label">Unique Regions</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="avg-participants">-</span>
                <span class="stat-label">Avg Participants (M)</span>
            </div>
        </div>

        <div id="sports-container">
            <!-- 
                id="sports-container" creates unique identifier
                JavaScript uses this ID to find and modify this element
                IDs must be unique (only one per page), unlike classes
            -->
            <div class="loading">Loading sports data...</div>
            <!-- Initial loading message, replaced by JavaScript -->
        </div>
    </div>

    <script>
        /* 
            JavaScript goes in <script> tags
            JavaScript makes pages interactive and dynamic
            This script loads XML data and displays it with filtering
        */
        
        // Global variables to store data
        let allSports = [];         // Array to store all sport data
        let currentFilter = 'all';  // Currently active filter
        
        function getRankClass(rank) {
            /*
                Function converts rank number to CSS class name
                Used for rank-specific styling and filtering
            */
            const rankNum = parseInt(rank);
            if (rankNum >= 1 && rankNum <= 5) return 'rank-1-5';
            if (rankNum >= 6 && rankNum <= 10) return 'rank-6-10';
            if (rankNum >= 11 && rankNum <= 15) return 'rank-11-15';
            if (rankNum >= 16 && rankNum <= 20) return 'rank-16-20';
            if (rankNum >= 21 && rankNum <= 25) return 'rank-21-25';
            return 'rank-other';
        }

        function formatParticipants(participants) {
            /*
                Function formats participant numbers for display
                Converts strings like "4_billion" to readable format
            */
            const cleanNum = participants.replace(/_/g, '');
            if (cleanNum.includes('billion')) {
                return cleanNum.replace('billion', 'B');
            } else if (cleanNum.includes('million')) {
                return cleanNum.replace('million', 'M');
            }
            return cleanNum;
        }

        function parseParticipantsToNumber(participants) {
            /*
                Function converts participant strings to numbers for calculations
                Used for statistics calculations
            */
            const cleanNum = participants.replace(/_/g, '').toLowerCase();
            if (cleanNum.includes('billion')) {
                return parseFloat(cleanNum.replace('billion', '')) * 1000;
            } else if (cleanNum.includes('million')) {
                return parseFloat(cleanNum.replace('million', ''));
            }
            return parseFloat(cleanNum);
        }

        function calculateStats(sports) {
            /*
                Function calculates statistics from sport data
                Returns object with counts for display
            */
            let totalParticipantsMillions = 0;
            const regionsSet = new Set(); // Set automatically removes duplicates
            
            sports.forEach(sport => {
                /*
                    forEach() runs function for each array item
                    Arrow function: (parameter) => { code }
                    More concise than: function(sport) { code }
                */
                totalParticipantsMillions += parseParticipantsToNumber(sport.participants);
                
                // Split regions by comma and add each to set
                sport.regions.split(',').forEach(region => {
                    regionsSet.add(region.trim());
                });
            });
            
            const avgParticipants = sports.length > 0 ? 
                Math.round(totalParticipantsMillions / sports.length) : 0;
            
            return {
                sports: sports.length,
                totalParticipants: (totalParticipantsMillions / 1000).toFixed(1), // Convert to billions
                uniqueRegions: regionsSet.size,
                avgParticipants: avgParticipants
            };
        }

        function updateStats(sports) {
            /*
                Function updates the statistics display
                Takes filtered sports array as input
            */
            const stats = calculateStats(sports);
            
            // Update each statistic display
            document.getElementById('total-sports').textContent = stats.sports;
            document.getElementById('total-participants').textContent = stats.totalParticipants;
            document.getElementById('unique-regions').textContent = stats.uniqueRegions;
            document.getElementById('avg-participants').textContent = stats.avgParticipants;
            /*
                .textContent sets the text inside an element
                Safer than .innerHTML when displaying user data
            */
        }

        function filterSports(rankRange) {
            /*
                Function filters sports by rank range
                Updates display and active filter button
            */
            currentFilter = rankRange;
            
            // Update active button styling
            document.querySelectorAll('.filter-btn').forEach(btn => {
                /*
                    querySelectorAll() finds all elements matching CSS selector
                    Returns NodeList (array-like) of elements
                */
                btn.classList.remove('active');
                /*
                    classList provides methods to manipulate CSS classes
                    .remove() removes specified class
                */
            });
            
            // Add active class to clicked button
            document.querySelector(`[data-rank="${rankRange}"]`).classList.add('active');
            /*
                querySelector() finds FIRST element matching CSS selector
                [data-rank="value"] is attribute selector
                .add() adds specified class
            */
            
            // Filter and display sports
            let filteredSports;
            if (rankRange === 'all') {
                filteredSports = allSports;
            } else {
                const [min, max] = rankRange.split('-').map(Number);
                filteredSports = allSports.filter(sport => {
                    const rank = parseInt(sport.rank);
                    return rank >= min && rank <= max;
                });
                /*
                    .filter() creates new array with items that pass test
                    Arrow function returns true/false for each item
                    Only items returning true are included
                */
            }
            
            displaySports(filteredSports);
            updateStats(filteredSports);
        }

        async function loadSportsData() {
            /*
                async function can use 'await' for asynchronous operations
                Async is needed because loading files takes time
                This prevents the page from freezing while loading data
            */
            
            try {
                /*
                    try/catch handles errors gracefully
                    Code in 'try' block runs normally
                    If error occurs, 'catch' block runs instead
                */
                
                // Fetch the XML file from server
                const response = await fetch('sports.xml');
                /*
                    fetch() loads files/data from URLs
                    await pauses function until fetch completes
                    const creates unchangeable variable
                */
                
                // Convert response to text
                const xmlText = await response.text();
                
                // Parse XML string into document object
                const parser = new DOMParser();
                /*
                    DOMParser is built-in browser API for parsing XML/HTML
                    Converts text into structured document we can navigate
                */
                const xmlDoc = parser.parseFromString(xmlText, 'text/xml');

                // Check if XML parsing failed
                if (xmlDoc.getElementsByTagName('parsererror').length > 0) {
                    throw new Error('XML parsing failed');
                    /*
                        throw creates custom error
                        This jumps directly to catch block
                    */
                }

                // Get all <sport> elements from XML
                const sports = xmlDoc.getElementsByTagName('sport');
                /*
                    getElementsByTagName() finds all elements with specified tag name
                    Returns HTMLCollection (array-like list of elements)
                */
                
                // Process each sport
                for (let i = 0; i < sports.length; i++) {
                    /*
                        for loop repeats code for each item
                        let i = 0: start counter at 0
                        i < sports.length: continue while counter less than total items
                        i++: add 1 to counter each time
                    */
                    
                    const sport = sports[i];  // Get current sport element
                    
                    // Extract sport information
                    const sportData = {
                        rank: sport.getAttribute('rank'),
                        name: sport.getElementsByTagName('sportname')[0].textContent,
                        participants: sport.getElementsByTagName('estimated_participants')[0].textContent,
                        regions: sport.getElementsByTagName('primary_regions')[0].textContent
                        /*
                            .getAttribute() gets HTML attribute value
                            .textContent gets the text inside an element
                        */
                    };
                    
                    allSports.push(sportData);
                    /*
                        .push() adds item to end of array
                        Builds up complete list of all sports
                    */
                }

                // Display all sports initially
                displaySports(allSports);
                updateStats(allSports);
                
            } catch (error) {
                /*
                    catch block runs if any error occurs in try block
                    'error' variable contains details about what went wrong
                */
                console.error('Error loading sports data:', error);
                /*
                    console.error() prints error message to browser developer tools
                    Helpful for debugging - users don't see this
                */
                
                // Show error message to user
                document.getElementById('sports-container').innerHTML = 
                    '<div class="error">Error loading sports.xml. Please ensure the file exists and is properly formatted.</div>';
                /*
                    document.getElementById() finds element with specified ID
                    .innerHTML replaces element's content with new HTML
                */
            }
        }

        function displaySports(sportsData) {
            /*
                Function that creates HTML from sports data
                Takes array of sport objects as input
            */
            
            // Find the container element
            const container = document.getElementById('sports-container');
            
            if (sportsData.length === 0) {
                // Show message when no sports match filter
                container.innerHTML = '<div class="loading">No sports found for the selected rank range.</div>';
                return;
            }
            
            // Generate HTML for each sport
            const html = `
                <div class="sports-container">
                    ${sportsData.map(sport => `
                        <div class="sport-card ${getRankClass(sport.rank)}">
                            <div class="sport-header">
                                <div class="sport-rank">#${sport.rank}</div>
                                <div class="sport-name">${sport.name}</div>
                                <div class="sport-participants">${formatParticipants(sport.participants)} participants</div>
                            </div>
                            <div class="sport-body">
                                <div class="section-title">Primary Regions</div>
                                <div class="regions-list">
                                    <div class="regions-text">${sport.regions}</div>
                                </div>
                                <div class="sport-links">
                                    <a href="leagues.html?sport=${encodeURIComponent(sport.name.toLowerCase())}" class="leagues-link">
                                        View Leagues
                                    </a>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            /*
                Template literals use backticks (`) instead of quotes
                ${} inserts JavaScript expressions into strings
                .map() transforms each array item using provided function
                .join('') combines array items into single string
            */
            
            // Replace loading message with generated HTML
            container.innerHTML = html;
        }

        // Event listeners for filter buttons
        document.addEventListener('DOMContentLoaded', function() {
            /*
                Event listener waits for specific events to happen
                'DOMContentLoaded' fires when HTML is fully loaded and parsed
                This ensures all elements exist before JavaScript tries to use them
            */
            
            // Load the sports data
            loadSportsData();
            
            // Add click handlers to filter buttons
            document.querySelectorAll('.filter-btn').forEach(button => {
                button.addEventListener('click', function() {
                    /*
                        addEventListener() attaches event handler to element
                        'click' event fires when user clicks the element
                        function() defines what happens when event occurs
                    */
                    const rankRange = this.dataset.rank;
                    /*
                        'this' refers to the clicked button element
                        .dataset accesses data-* attributes
                        data-rank="value" becomes dataset.rank
                    */
                    filterSports(rankRange);
                });
            });
        });
    </script>
</body>
</html>